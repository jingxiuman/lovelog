<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title></title>
    <link rel="stylesheet" type="text/css" href="css/style.css"/>
</head>
<body>


<div class="mui-content main_content list_content">
   <!--<div class="list_box">
       <div class="list_box_user">zhoubenbentime</div>
       <div class="list_box_main">
           <div class="list_box_day"><span class="list_box_day_num">132</span><span class="list_box_day_name">天</span></div>
           <div class="list_box_event">恋爱纪念日</div>
       </div>
   </div>-->
</div>
 <script src="js/lib/mui.min.js" type="text/javascript" charset="utf-8"></script>
	<script src = "https://cdn.wilddog.com/js/client/current/wilddog.js" ></script>
	<script src="js/lib/FFF.fc.min.js" type="text/javascript" charset="utf-8"></script>
	<script>
		require(['FFF', 'zepto'], function(FFF, $){
			var F = FFF.FFF,Widght = F.Widght;
			
			function listBox(){
				Widght.apply(this, arguments);
			}
			
			listBox.ATTRS = {
				boudingBox :{
					value :$("<div class='list_box'></div>")
				},
				boxDay:{
	            	value:'',
		        },
		        boxInfo:{
		            value:''
		        },
		        boxID:{
		            value:''
		        },  
				username:{
					value:""
				}
			}
			F.extend(listBox, Widght, {
				initialize: function(obj){
					 var nowDay = new Date();
		            var dayNum = parseInt((nowDay.getTime() - obj.boxDay) / 86400000);
		            this.setBoxDay(dayNum);
	            	this.setBoxInfo(obj.boxInfo);
		         	this.setBoxID(obj.boxId);
		         	this.setUsername(obj.boxUserID);
				},
				renderUI:function(){
					var that = this, boxList = that.getBoundingBox();
					var list_user = '<div class="list_box_user">'+that.getUsername()+'</div>';
					var list_main = '<div class="list_box_main"><div class="list_box_day">'+
					'<span class="list_box_day_num">'+that.getBoxDay()+'</span><span class="list_box_day_name">天</span></div>'+
					'<div class="list_box_event">'+that.getBoxInfo()+'</div></div>';
					boxList.append(list_user);
					boxList.append(list_main);
				}
			});
			var rootRef = new Wilddog('https://lovelog.wilddogio.com/boxList');
			rootRef.on("child_added",function(snapshot){
			var value = snapshot.val();
				//console.log(all)
				console.log(snapshot.key());
				
				if(value.eventShow == "1"){
					var box = new listBox({
				   		boxDay: value.eventTime,
			         	boxInfo:value.eventName,
			         	boxId:snapshot.key(),
			         	boxUserId: value.userID
					});
					box.render({
				   		container: $(".list_content"),
		            	type:'append'
					});
				}
			//console.log(all.eventName)
			}, function(err){
				console.log(err.code)
			})				
			
		})
	</script>
</body>
</html>